import{d as x,j as I,c as g,a as i,u as p,m as o,Y as N,Z as P,w as l,$,g as s,o as u,e as B,F as L,b as G,f as T,s as U,N as R,_ as F}from"./index-6ebd5fd7.js";const j={class:"list"},q={class:"category-header"},z={class:"category-header-search"},D={class:"content"},E=x({__name:"GoodList",setup(M){const _=U(),m=R(),e=I({keyword:"",active:"",refreshing:!1,loading:!1,finished:!1,page:1,totalPage:0,list:[]}),h=()=>{d()},v=()=>{d()},d=()=>{e.refreshing=!0,e.finished=!1,e.loading=!0,e.page=1,f()},f=()=>{!e.refreshing&&e.page<e.totalPage&&e.page++,e.refreshing&&(e.list=[],e.refreshing=!1),y()},y=async()=>{const r=m.query.categoryId;if(!r&&!e.keyword){e.finished=!0,e.loading=!1;return}const t={pageNumber:e.page,keyword:e.keyword,orderBy:e.active,goodsCategoryId:r},{data:{data:n}}=await $(t);e.list=e.list.concat(n.list),e.totalPage=n.totalPage,e.loading=!1,e.page>=e.totalPage&&(e.finished=!0)};return(r,t)=>{const n=s("van-icon"),b=s("van-button"),c=s("van-tab"),k=s("van-tabs"),w=s("van-card"),C=s("van-list"),V=s("van-pull-refresh");return u(),g("div",j,[i("header",q,[i("div",{class:"category-header-icon",onClick:t[0]||(t[0]=a=>p(_).back())},[o(n,{name:"arrow-left"})]),i("div",z,[o(n,{class:"category-header-search-icon",name:"search"}),N(i("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>e.keyword=a),class:"category-header-search-ph",placeholder:"山河无恙，人间皆安"},null,512),[[P,e.keyword]])]),o(b,{color:"#1baeae",size:"mini",onClick:h},{default:l(()=>[B("搜索")]),_:1})]),o(k,{modelValue:e.active,"onUpdate:modelValue":t[2]||(t[2]=a=>e.active=a),type:"card",color:"#1baeae",onClickTab:v},{default:l(()=>[o(c,{title:"推荐",name:""}),o(c,{title:"新品",name:"new"}),o(c,{title:"价格",name:"price"})]),_:1},8,["modelValue"]),i("div",D,[o(V,{modelValue:e.refreshing,"onUpdate:modelValue":t[4]||(t[4]=a=>e.refreshing=a),onRefresh:d,class:"good-list"},{default:l(()=>[o(C,{loading:e.loading,"onUpdate:loading":t[3]||(t[3]=a=>e.loading=a),finished:e.finished,"finished-text":"没有更多了",onLoad:f},{default:l(()=>[(u(!0),g(L,null,G(e.list,a=>(u(),T(w,{price:`${a.sellingPrice}.00`,desc:a.goodsIntro,title:a.goodsName,thumb:r.$filters.prefix(a.goodsCoverImg),onClick:Y=>p(_).push(`/info/${a.goodsId}`)},null,8,["price","desc","title","thumb","onClick"]))),256))]),_:1},8,["loading","finished"])]),_:1},8,["modelValue"])])])}}});const A=F(E,[["__scopeId","data-v-4ad83aa5"]]);export{A as default};
